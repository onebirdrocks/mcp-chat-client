<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Theme Test</title>
    <style>
        /* Basic theme styles */
        html {
            transition: background-color 0.3s, color 0.3s;
        }
        
        html:not(.dark) {
            background-color: #ffffff;
            color: #1f2937;
        }
        
        html.dark {
            background-color: #111827;
            color: #f9fafb;
        }
        
        .container {
            max-width: 800px;
            margin: 0 auto;
            padding: 2rem;
            font-family: system-ui, -apple-system, sans-serif;
        }
        
        .theme-controls {
            margin-bottom: 2rem;
            padding: 1rem;
            border: 1px solid currentColor;
            border-radius: 8px;
        }
        
        button {
            margin: 0.5rem;
            padding: 0.5rem 1rem;
            border: 1px solid currentColor;
            background: transparent;
            color: inherit;
            border-radius: 4px;
            cursor: pointer;
        }
        
        button:hover {
            background: currentColor;
            color: var(--bg-color);
        }
        
        .debug-info {
            margin-top: 2rem;
            padding: 1rem;
            border: 1px solid currentColor;
            border-radius: 8px;
            font-family: monospace;
            font-size: 0.875rem;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Theme Test Page</h1>
        
        <div class="theme-controls">
            <h2>Theme Controls</h2>
            <button onclick="applyLight()">‚òÄÔ∏è Light</button>
            <button onclick="applyDark()">üåô Dark</button>
            <button onclick="applySystem()">üíª System</button>
            <button onclick="clearTheme()">üßπ Clear</button>
        </div>
        
        <div>
            <h2>Sample Content</h2>
            <p>This is a paragraph to test text visibility in different themes.</p>
            <p>The background should change when you click the theme buttons above.</p>
            <ul>
                <li>Light theme: white background, dark text</li>
                <li>Dark theme: dark background, light text</li>
                <li>System theme: follows your OS preference</li>
            </ul>
        </div>
        
        <div class="debug-info" id="debug-info">
            <h3>Debug Info</h3>
            <div id="debug-content">Loading...</div>
        </div>
    </div>

    <script>
        function updateDebugInfo() {
            const info = {
                localStorage: localStorage.getItem('mcp-chat-ui-theme'),
                documentClass: document.documentElement.className,
                hasDarkClass: document.documentElement.classList.contains('dark'),
                systemPreference: window.matchMedia('(prefers-color-scheme: dark)').matches,
                computedBgColor: window.getComputedStyle(document.documentElement).backgroundColor,
                computedColor: window.getComputedStyle(document.documentElement).color,
            };
            
            document.getElementById('debug-content').innerHTML = `
                <div>localStorage: ${info.localStorage || 'null'}</div>
                <div>document.className: '${info.documentClass}'</div>
                <div>has dark class: ${info.hasDarkClass}</div>
                <div>system prefers dark: ${info.systemPreference}</div>
                <div>computed bg: ${info.computedBgColor}</div>
                <div>computed color: ${info.computedColor}</div>
            `;
        }
        
        function applyTheme(theme) {
            const root = document.documentElement;
            
            // Clear existing classes
            root.classList.remove('dark');
            root.offsetHeight; // Force reflow
            
            if (theme === 'dark') {
                root.classList.add('dark');
                console.log('üåô Applied dark theme');
            } else if (theme === 'light') {
                // Already removed dark class above
                console.log('‚òÄÔ∏è Applied light theme');
            } else if (theme === 'system') {
                const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
                if (prefersDark) {
                    root.classList.add('dark');
                    console.log('üåô Applied system dark theme');
                } else {
                    console.log('‚òÄÔ∏è Applied system light theme');
                }
            }
            
            localStorage.setItem('mcp-chat-ui-theme', theme);
            root.offsetHeight; // Force reflow
            updateDebugInfo();
        }
        
        function applyLight() {
            applyTheme('light');
        }
        
        function applyDark() {
            applyTheme('dark');
        }
        
        function applySystem() {
            applyTheme('system');
        }
        
        function clearTheme() {
            document.documentElement.classList.remove('dark');
            document.documentElement.className = '';
            localStorage.removeItem('mcp-chat-ui-theme');
            console.log('üßπ Cleared theme');
            updateDebugInfo();
        }
        
        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            const savedTheme = localStorage.getItem('mcp-chat-ui-theme') || 'system';
            applyTheme(savedTheme);
            
            // Update debug info every second
            setInterval(updateDebugInfo, 1000);
        });
    </script>
</body>
</html>